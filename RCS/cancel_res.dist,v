head	1.4;
access;
symbols;
locks; strict;
comment	@# @;


1.4
date	2004.08.23.22.09.05;	author kenneth;	state Exp;
branches;
next	1.3;

1.3
date	2003.03.07.23.40.19;	author kenneth;	state Exp;
branches;
next	1.2;

1.2
date	2002.12.21.04.14.12;	author kenneth;	state Exp;
branches;
next	1.1;

1.1
date	2001.09.12.21.33.28;	author kenneth;	state Exp;
branches;
next	;


desc
@cancel a reservation instance
@


1.4
log
@log cancels
@
text
@#!___PYTHON_PATH_PLACEHOLDER___
# script to cancel a reservation, given a res_id

import getopt
import sys
import string
import Catalina
import copy

RESERVATIONS_DB = Catalina.RESERVATIONS_DB

usage_string = \
"""
Usage: cancel_res [--res=<res id>[,<res id>...]]
                  [--?]
                  [--help]"""

options = ['res=',
  '?',
  'help'
  ]
args = sys.argv[1:]
argdict = {}
optlist, lineargs = getopt.getopt(args, '', options)
for pair in optlist:
        argdict[pair[0]] = pair[1]

if argdict.has_key('--?') or argdict.has_key('--help') :
    print usage_string
    sys.exit(0)

if not argdict.has_key('--res') :
    print "--res=<res_id> required!"
    print usage_string
    sys.exit(1)
else :
    res_list = string.split(argdict['--res'], ",")
    events_db_handle = Catalina.open_db(Catalina.EVENTS_DB,'write');
    db_handle = Catalina.open_db(RESERVATIONS_DB,'write');
    for res_name in res_list :
        event = {
          'name' : 'cancel_res',
          'res' : copy.deepcopy(db_handle[0][res_name]),
        }
        Catalina.log_event(event, events_db_handle)
        Catalina.delete_object(res_name, db_handle)
    Catalina.close_db(db_handle)
    Catalina.close_db(events_db_handle)
@


1.3
log
@added comma-delimited list to --res
@
text
@d8 1
d38 1
d41 5
d48 1
@


1.2
log
@consistent opts
@
text
@d6 1
d13 1
a13 1
Usage: cancel_res [--res=<res id>]
d36 1
d38 2
a39 1
    Catalina.delete_object(argdict['--res'], db_handle)
@


1.1
log
@Initial revision
@
text
@d10 10
a19 1
options = ['res_id=']
d26 7
a32 2
if not argdict.has_key('--res_id') :
    print "--res_id=<res_id> required!"
d36 1
a36 1
    Catalina.delete_object(argdict['--res_id'], db_handle)
@
