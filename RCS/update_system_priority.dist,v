head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2003.04.09.17.01.51;	author kenneth;	state Exp;
branches;
next	1.4;

1.4
date	2003.04.09.16.57.33;	author kenneth;	state Exp;
branches;
next	1.3;

1.3
date	2002.12.21.04.20.27;	author kenneth;	state Exp;
branches;
next	1.2;

1.2
date	2001.10.31.23.13.16;	author kenneth;	state Exp;
branches;
next	1.1;

1.1
date	2001.09.12.21.31.17;	author kenneth;	state Exp;
branches;
next	;


desc
@set or unset system priority for a job
@


1.5
log
@print usage and exit, if no job or no priority
@
text
@#!___PYTHON_PATH_PLACEHOLDER___
# script to update system priority of a job
# if system_priority is 0, then system priority will be canceled

import Catalina
import sys
import getopt
import string

options = ['?', 'help', 'job=', 'system_priority=']

args = sys.argv[1:]
argdict = {}
optlist, lineargs = getopt.getopt(args, '', options)
for pair in optlist :
    argdict[pair[0]] = pair[1]
    if pair[0] == '--job' :
        job_step_id = pair[1]
    elif pair[0] == '--system_priority' :
        system_priority_int = string.atoi(pair[1])

usage_string = \
"""Usage: update_system_priority --job=<job id>
                                 --system_priority=<integer>
                                 [--?]
                                 [--help]"""
if argdict.has_key('--?') or argdict.has_key('--help') :
    print usage_string
    sys.exit(0)

if not ( argdict.has_key('--job') and argdict.has_key('--system_priority') ) :
    print usage_string
    sys.exit(0)

JOBS_DB = Catalina.JOBS_DB

jobs_db_handle = Catalina.open_db(JOBS_DB,'write')

try :
    temp_job = Catalina.get_object(job_step_id, jobs_db_handle)
except 'KeyNotFound' :
    print "Job (%s) not found in Catalina DB" % job_step_id
    Catalina.close_db(jobs_db_handle)
    sys.exit(1)

Catalina.set_system_priority( temp_job, system_priority_int, jobs_db_handle )

Catalina.close_db(jobs_db_handle)
@


1.4
log
@added --help --?
@
text
@d23 2
a24 1
"""Usage: update_system_priority [--job=<job id> --system_priority=<integer>]
d28 4
@


1.3
log
@consistent opts
@
text
@d10 1
a10 1
options = ['job=', 'system_priority=']
a28 1

@


1.2
log
@changed locking order
@
text
@d10 1
a10 1
options = ['job_step_id=', 'system_priority=']
d13 1
d16 2
a17 1
    if pair[0] == '--job_step_id' :
d21 9
@


1.1
log
@Initial revision
@
text
@d20 1
a20 1
JOBS_DB = 'jobs'
@
